# DriverBox

<div align="center">

[![Go Version](https://img.shields.io/badge/Go-1.23+-00ADD8?style=flat&logo=go)](https://golang.org/)
[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](LICENSE)
[![Documentation](https://img.shields.io/badge/docs-latest-green.svg)](https://ibuilding-x.github.io/driver-box/)
[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/ibuilding-X/driver-box)

ä¸€æ¬¾æ”¯æŒæ³›åŒ–åè®®æ¥å…¥çš„è½»é‡çº§è¾¹ç¼˜ç½‘å…³æ¡†æ¶ï¼Œé€šè¿‡æ’ä»¶åŒ–å’ŒLuaè„šæœ¬å®ç°çµæ´»çš„è®¾å¤‡æ¥å…¥èƒ½åŠ›ã€‚

[å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹) Â· [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§) Â· [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡) Â· [äºŒæ¬¡å¼€å‘](#äºŒæ¬¡å¼€å‘) Â· [APIæ–‡æ¡£](#apiæ–‡æ¡£)

</div>

---

## ğŸ“– ç®€ä»‹

DriverBox æ˜¯ä¸€æ¬¾ä¸“ä¸ºç‰©è”ç½‘åœºæ™¯è®¾è®¡çš„è¾¹ç¼˜ç½‘å…³æ¡†æ¶ï¼Œé‡‡ç”¨**æ’ä»¶åŒ–æ¶æ„**èåˆäº† Modbusã€BACnetã€HTTPã€MQTTã€WebSocket ç­‰ä¸»æµå·¥ä¸šåè®®ï¼ŒåŒæ—¶æ”¯æŒåŸºäº TCP çš„å„ç±»ç§æœ‰åè®®çš„æ— ç¼å¯¹æ¥ã€‚

### è®¾è®¡ç†å¿µ

é€šè¿‡å¯¹å„ç±»è®¾å¤‡çš„é€šä¿¡åè®®å’Œæ•°æ®äº¤äº’å½¢å¼è¿›è¡ŒæŠ½è±¡ï¼Œå®šä¹‰äº†ä¸€å¥—**æ ‡å‡†åŒ–çš„è®¾å¤‡æ¥å…¥æµç¨‹**ï¼Œæ¶µç›–å„ç±»é€šä¿¡åè®®çš„å…±æ€§é€»è¾‘ã€‚åŒæ—¶ï¼Œç»“åˆ**åŠ¨æ€ Lua è„šæœ¬å¼•æ“**å¡«è¡¥åè®®å·®å¼‚åŒ–çš„éƒ¨åˆ†ï¼Œå®ç°äº†ï¼š

- âœ… **è§£å†³é©±åŠ¨å·¥ç¨‹æ•°é‡çˆ†ç‚¸**é—®é¢˜ - é€šè¿‡é…ç½®åŒ–å’Œè„šæœ¬åŒ–å¤§å¹…å‡å°‘é‡å¤å¼€å‘
- âœ… **ç»Ÿä¸€æ¥å…¥æ ‡å‡†** - å»ºç«‹è§„èŒƒåŒ–çš„è®¾å¤‡æ¥å…¥æµç¨‹
- âœ… **é™ä½æŠ€æœ¯é—¨æ§›** - ç†æƒ³æƒ…å†µä¸‹ä»…éœ€ç¼–å†™ JSON é…ç½®æ–‡ä»¶å³å¯å®Œæˆè®¾å¤‡æ¥å…¥
- âœ… **çµæ´»æ‰©å±•èƒ½åŠ›** - æ”¯æŒè‡ªå®šä¹‰æ’ä»¶å’Œ Lua è„šæœ¬åº”å¯¹å¤æ‚åœºæ™¯

æˆ‘ä»¬æœŸæœ› DriverBox èƒ½å¤Ÿä¸º IoT å¼€å‘è€…æä¾›æ›´åŠ é«˜æ•ˆã€èˆ’é€‚çš„è®¾å¤‡æ¥å…¥ä½“éªŒã€‚

---

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ğŸ’ è½»é‡é«˜æ•ˆ

- **æç®€æ¶æ„**ï¼šGo è¯­è¨€å¼€å‘ï¼Œå•æ–‡ä»¶ç¼–è¯‘ï¼Œä½“ç§¯æ§åˆ¶åœ¨ 10-20MB
- **ä½èµ„æºå ç”¨**ï¼šè¿è¡Œå†…å­˜éœ€æ±‚ä½ï¼Œæ»¡è¶³ä½è§„æ ¼è¾¹ç¼˜ç½‘å…³çš„è¿è¡Œè¦æ±‚
- **è·¨å¹³å°æ”¯æŒ**ï¼šæ”¯æŒ amd64ã€arm64ã€armv7ã€x86 ç­‰å¤šç§ç³»ç»Ÿæ¶æ„
- **é«˜æ€§èƒ½å¹¶å‘**ï¼šåŸºäº Go åç¨‹å®ç°é«˜æ•ˆçš„å¹¶å‘æ•°æ®å¤„ç†

### ğŸ”Œ æ’ä»¶åŒ–æ¶æ„

- **åè®®æ’ä»¶**ï¼šå†…ç½® Modbusã€BACnetã€HTTPã€MQTTã€WebSocket ç­‰ä¸»æµåè®®æ”¯æŒ
- **æ•°æ®å¯¼å‡º**ï¼šæ”¯æŒå¤šç§æ•°æ®å¯¼å‡ºæ–¹å¼ï¼ˆMQTTã€HTTPã€LinkEdge ç­‰ï¼‰
- **çƒ­æ’æ‹”**ï¼šæ”¯æŒæ’ä»¶åŠ¨æ€åŠ è½½ã€å¸è½½å’Œé…ç½®çƒ­é‡è½½
- **æ— é™æ‰©å±•**ï¼šå¼€æ”¾æ’ä»¶æ¥å£ï¼Œå¼€å‘è€…å¯è½»æ¾æ‰©å±•åè®®å’ŒåŠŸèƒ½

### ğŸ“œ Lua è„šæœ¬å¼•æ“

- **åŠ¨æ€è§£æ**ï¼šé€šè¿‡ Lua è„šæœ¬å®ç°å¤æ‚åè®®çš„æ•°æ®è§£æå’Œå¤„ç†
- **ä¸šåŠ¡é€»è¾‘**ï¼šæ”¯æŒåœ¨è„šæœ¬ä¸­ç¼–å†™è®¾å¤‡ç‰¹å®šçš„ä¸šåŠ¡é€»è¾‘
- **å†…ç½®åº“æ”¯æŒ**ï¼šæä¾›ä¸°å¯Œçš„å†…ç½® Lua åº“ï¼ˆHTTPã€JSONã€æ•°å­¦è®¡ç®—ç­‰ï¼‰
- **çƒ­æ›´æ–°**ï¼šæ”¯æŒè¿è¡Œæ—¶æ›´æ–°è„šæœ¬ï¼Œæ— éœ€é‡å¯æœåŠ¡

### ğŸŒ ä¸°å¯Œçš„ API

- **RESTful API**ï¼šæä¾›å®Œæ•´çš„è®¾å¤‡ç®¡ç†ã€æ•°æ®æŸ¥è¯¢ã€æ§åˆ¶æŒ‡ä»¤ç­‰ API
- **WebSocket**ï¼šæ”¯æŒå®æ—¶æ•°æ®æ¨é€å’ŒåŒå‘é€šä¿¡
- **äº‹ä»¶æœºåˆ¶**ï¼šæ”¯æŒè®¾å¤‡äº‹ä»¶è®¢é˜…å’Œè‡ªå®šä¹‰äº‹ä»¶å¤„ç†
- **æ—  UI ä¾èµ–**ï¼šå¼€æ”¾ APIï¼Œç”¨æˆ·å¯è‡ªç”±å®šåˆ¶ç½‘å…³ UI ç•Œé¢

### ğŸ“Š æ•°æ®ç®¡ç†

- **è®¾å¤‡å½±å­**ï¼šè®¾å¤‡çŠ¶æ€ç¼“å­˜å’Œç¦»çº¿æ•°æ®ç¼“å­˜
- **å†å²æ•°æ®**ï¼šå¯é€‰çš„æ—¶åºæ•°æ®å­˜å‚¨æ”¯æŒ
- **å¤šæ ¼å¼å¯¼å‡º**ï¼šæ”¯æŒ JSONã€Modbus Server ç­‰å¤šç§æ•°æ®æ ¼å¼å¯¼å‡º
- **é…ç½®ç®¡ç†**ï¼šåŸºäºæ–‡ä»¶çš„é…ç½®ç®¡ç†å’Œç‰ˆæœ¬æ§åˆ¶

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Export Layer                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ LinkEdge â”‚ â”‚   MQTT   â”‚ â”‚ Gateway  â”‚ â”‚ History/Discover â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Plugin Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Modbus  â”‚ â”‚  BACnet  â”‚ â”‚   MQTT   â”‚ â”‚ HTTP/WebSocket  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Library Layer                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Driver Scripts (Lua) + Protocol Scripts (Lua)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DriverBox Core                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Cache   â”‚ â”‚  Shadow  â”‚ â”‚  Event   â”‚ â”‚   Crontab        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
driver-box/
â”œâ”€â”€ driverbox/          # æ ¸å¿ƒæ¡†æ¶
â”‚   â”œâ”€â”€ driverbox.go    # ä¸»å…¥å£
â”‚   â”œâ”€â”€ plugin.go       # æ’ä»¶ç®¡ç†
â”‚   â”œâ”€â”€ export.go       # å¯¼å‡ºç®¡ç†
â”‚   â”œâ”€â”€ shadow.go       # è®¾å¤‡å½±å­
â”‚   â””â”€â”€ crontab.go      # å®šæ—¶ä»»åŠ¡
â”œâ”€â”€ plugins/            # å†…ç½®åè®®æ’ä»¶
â”‚   â”œâ”€â”€ modbus/         # Modbus åè®®
â”‚   â”œâ”€â”€ bacnet/         # BACnet åè®®
â”‚   â”œâ”€â”€ mqtt/           # MQTT åè®®
â”‚   â”œâ”€â”€ httpclient/     # HTTP å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ httpserver/     # HTTP æœåŠ¡ç«¯
â”‚   â”œâ”€â”€ tcpserver/      # TCP æœåŠ¡ç«¯
â”‚   â”œâ”€â”€ websocket/      # WebSocket åè®®
â”‚   â””â”€â”€ dlt645/         # DLT645 åè®®
â”œâ”€â”€ exports/            # æ•°æ®å¯¼å‡ºæ’ä»¶
â”‚   â”œâ”€â”€ linkedge/       # LinkEdge å¯¼å‡º
â”‚   â”œâ”€â”€ mirror/         # é•œåƒå¯¼å‡º
â”‚   â”œâ”€â”€ discover/       # è®¾å¤‡å‘ç°
â”‚   â”œâ”€â”€ gateway/        # ç½‘å…³å¯¼å‡º
â”‚   â””â”€â”€ modbusserver/   # Modbus Server å¯¼å‡º
â”œâ”€â”€ internal/           # å†…éƒ¨å®ç°
â”‚   â”œâ”€â”€ core/           # æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ cache/          # ç¼“å­˜ç®¡ç†
â”‚   â”œâ”€â”€ export/         # å¯¼å‡ºæ¥å£
â”‚   â””â”€â”€ shadow/         # å½±å­æœåŠ¡
â”œâ”€â”€ pkg/                # å…¬å…±åŒ…
â”‚   â”œâ”€â”€ config/         # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ event/          # äº‹ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ library/        # è„šæœ¬åº“
â”‚   â””â”€â”€ crontab/        # å®šæ—¶ä»»åŠ¡
â”œâ”€â”€ res/                # èµ„æºç›®å½•ï¼ˆè¿è¡Œæ—¶ï¼‰
â”‚   â”œâ”€â”€ library/
â”‚   â”‚   â”œâ”€â”€ driver/     # è®¾å¤‡é©±åŠ¨è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ protocol/   # åè®®è§£æè„šæœ¬
â”‚   â”‚   â”œâ”€â”€ device_tpl/ # è®¾å¤‡æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ common_tpl/ # é€šç”¨æ¨¡æ¿
â”‚   â”œâ”€â”€ computing/      # è®¡ç®—ä»»åŠ¡
â”‚   â””â”€â”€ history_data/   # å†å²æ•°æ®
â”œâ”€â”€ pages/              # æ–‡æ¡£ç«™ç‚¹
â”œâ”€â”€ main.go             # åº”ç”¨å…¥å£
â”œâ”€â”€ go.mod              # Go ä¾èµ–
â”œâ”€â”€ Dockerfile          # Docker é•œåƒ
â””â”€â”€ deploy.sh           # æ„å»ºè„šæœ¬
```

---

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Go**: 1.23 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: Linux / Windows / macOS
- **æ¶æ„**: amd64 / arm64 / armv7

### å®‰è£…

#### 1. ä¸‹è½½æºç 

```bash
git clone https://github.com/ibuilding-X/driver-box.git
cd driver-box
```

#### 2. åŠ è½½ä¾èµ–

```bash
# å›½å†…ç”¨æˆ·æ¨èä½¿ç”¨é•œåƒ
go env -w GOPROXY=https://goproxy.cn,direct

# åŠ è½½ä¾èµ–
go mod tidy
```

#### 3. è¿è¡Œ

```bash
# ç›´æ¥è¿è¡Œ
go run main.go

# æˆ–ç¼–è¯‘åè¿è¡Œ
go build -o driver-box
./driver-box
```

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t driver-box:latest .

# è¿è¡Œå®¹å™¨
docker run -d \
  -p 59999:59999 \
  -v $(pwd)/res:/res \
  --name driver-box \
  driver-box:latest
```

### äº¤å‰ç¼–è¯‘

é¡¹ç›®æä¾›äº†è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ï¼Œæ”¯æŒå¤šå¹³å°äº¤å‰ç¼–è¯‘ï¼š

```bash
# æ‰§è¡Œæ„å»ºè„šæœ¬
bash deploy.sh

# è¾“å‡ºç›®å½•
_output/
â”œâ”€â”€ driver-box-linux-arm64-v1.0.0.tar.gz
â”œâ”€â”€ driver-box-linux-amd64-v1.0.0.tar.gz
â””â”€â”€ ...
```

### é…ç½®è¯´æ˜

DriverBox ä½¿ç”¨ `res/` ç›®å½•ä½œä¸ºé…ç½®èµ„æºç›®å½•ï¼Œå¯åŠ¨æ—¶å¯é€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šï¼š

```bash
# é»˜è®¤é…ç½®è·¯å¾„
export RESOURCE_PATH="./res"

# è‡ªå®šä¹‰é…ç½®è·¯å¾„
export RESOURCE_PATH="/opt/driver-box/res"

# è®¾ç½®æ—¥å¿—çº§åˆ«
export LOG_LEVEL="info"
export LOG_PATH="./logs"
```

---

## ğŸ”Œ å†…ç½®æ’ä»¶

### åè®®æ’ä»¶

| æ’ä»¶åç§° | åè®®ç±»å‹ | è¯´æ˜ |
|---------|---------|------|
| `modbus` | Modbus RTU/TCP | å·¥ä¸šé€šç”¨åè®®ï¼Œæ”¯æŒä¸²å£å’ŒTCP |
| `bacnet` | BACnet/IP | æ¥¼å®‡è‡ªåŠ¨åŒ–æ ‡å‡†åè®® |
| `mqtt` | MQTT | ç‰©è”ç½‘è½»é‡çº§æ¶ˆæ¯åè®® |
| `httpclient` | HTTP Client | HTTP å®¢æˆ·ç«¯ï¼Œæ”¯æŒ REST API |
| `httpserver` | HTTP Server | HTTP æœåŠ¡ç«¯ï¼Œæä¾› API æ¥å£ |
| `tcpserver` | TCP Server | TCP æœåŠ¡ç«¯ï¼Œæ”¯æŒè‡ªå®šä¹‰åè®® |
| `websocket` | WebSocket | å®æ—¶åŒå‘é€šä¿¡åè®® |
| `dlt645` | DLT645 | ç”µèƒ½è¡¨é€šä¿¡åè®® |

### å¯¼å‡ºæ’ä»¶

| æ’ä»¶åç§° | åŠŸèƒ½è¯´æ˜ |
|---------|---------|
| `linkedge` | é˜¿é‡Œäº‘ LinkEdge æ•°æ®å¯¼å‡º |
| `mirror` | è®¾å¤‡æ•°æ®é•œåƒå¯¼å‡º |
| `discover` | è®¾å¤‡è‡ªåŠ¨å‘ç°æœåŠ¡ |
| `gateway` | ç½‘å…³æ•°æ®èšåˆå¯¼å‡º |
| `modbusserver` | Modbus Server æ¨¡å¼å¯¼å‡º |

### å¯ç”¨æ’ä»¶

åœ¨ `main.go` ä¸­å¯ç”¨éœ€è¦çš„æ’ä»¶ï¼š

```go
package main

import (
    "github.com/ibuilding-x/driver-box/driverbox"
    "github.com/ibuilding-x/driver-box/plugins"
    "github.com/ibuilding-x/driver-box/exports"
)

func main() {
    // å¯ç”¨æ‰€æœ‰å†…ç½®æ’ä»¶
    plugins.EnableAll()
    exports.EnableAll()

    // æˆ–è€…å•ç‹¬å¯ç”¨ç‰¹å®šæ’ä»¶
    // plugins.EnablePlugin("modbus", &modbus.Plugin{})
    // exports.EnableExport(&linkedge.Export{})

    // å¯åŠ¨æœåŠ¡
    driverbox.Start()
    select {}
}
```

---

## ğŸ“ é…ç½®åŒ–è®¾å¤‡æ¥å…¥

### JSON é…ç½®æ–¹å¼

å¯¹äºæ ‡å‡†è®¾å¤‡ï¼Œé€šå¸¸åªéœ€ç¼–å†™ JSON é…ç½®æ–‡ä»¶å³å¯å®Œæˆæ¥å…¥ï¼š

```json
{
  "devices": [
    {
      "id": "modbus-device-001",
      "name": "æ¸©åº¦ä¼ æ„Ÿå™¨",
      "plugin": "modbus",
      "protocol": "rtu",
      "config": {
        "port": "/dev/ttyUSB0",
        "baudRate": 9600,
        "dataBits": 8,
        "stopBits": 1,
        "parity": "none",
        "slaveId": 1
      },
      "points": [
        {
          "name": "temperature",
          "address": 40001,
          "type": "float",
          "scale": 0.1
        },
        {
          "name": "humidity",
          "address": 40002,
          "type": "float",
          "scale": 0.1
        }
      ]
    }
  ]
}
```

### Lua è„šæœ¬æ–¹å¼

å¯¹äºå¤æ‚è®¾å¤‡ï¼Œå¯ä»¥ç»“åˆ Lua è„šæœ¬å®ç°é«˜çº§åŠŸèƒ½ï¼š

#### è®¾å¤‡é©±åŠ¨è„šæœ¬ (`res/library/driver/xxx.lua`)

```lua
-- æ•°æ®è§£æ
function parse(data, point, device)
    -- å°†åŸå§‹æ•°æ®è§£æä¸ºç‚¹ä½å€¼
    local value = bit.lshift(data[1], 8) + data[2]
    return value * 0.1
end

-- æ•°æ®ç¼–ç 
function encode(value, point, device)
    -- å°†ç‚¹ä½å€¼ç¼–ç ä¸ºåŸå§‹æ•°æ®
    local data = value * 10
    return {bit.rshift(data, 8), bit.band(data, 0xFF)}
end

-- æ•°æ®éªŒè¯
function validate(value, point, device)
    -- éªŒè¯æ•°æ®æœ‰æ•ˆæ€§
    return value >= 0 and value <= 100
end
```

#### åè®®è§£æè„šæœ¬ (`res/library/protocol/xxx.lua`)

```lua
-- åè®®åˆå§‹åŒ–
function init(config)
    -- åˆå§‹åŒ–åè®®é…ç½®
    return true
end

-- è¯·æ±‚æ•°æ®åŒ…æ„å»º
function buildRequest(device, points)
    -- æ„å»ºè¯·æ±‚æ•°æ®åŒ…
    return request
end

-- å“åº”æ•°æ®åŒ…è§£æ
function parseResponse(response, device, points)
    -- è§£æå“åº”æ•°æ®åŒ…
    local result = {}
    for i, point in ipairs(points) do
        result[point.name] = parseData(response, point)
    end
    return result
end
```

---

## ğŸ”§ äºŒæ¬¡å¼€å‘

DriverBox æä¾›äº†å®Œå–„çš„äºŒæ¬¡å¼€å‘èƒ½åŠ›ï¼Œæ”¯æŒè‡ªå®šä¹‰æ’ä»¶å’Œè„šæœ¬ã€‚

### å¼€å‘è‡ªå®šä¹‰æ’ä»¶

#### 1. å®ç°åè®®æ’ä»¶

```go
package myprotocol

import (
    "github.com/ibuilding-x/driver-box/driverbox/plugin"
)

type MyProtocol struct {
    // æ’ä»¶å­—æ®µ
}

func (p *MyProtocol) Initialize(config map[string]interface{}) error {
    // åˆå§‹åŒ–æ’ä»¶
    return nil
}

func (p *MyProtocol) Destroy() error {
    // é”€æ¯æ’ä»¶ï¼Œæ¸…ç†èµ„æº
    return nil
}

func (p *MyProtocol) GetConnector() plugin.Connector {
    // è¿”å›è¿æ¥å™¨å®ä¾‹
    return &MyConnector{}
}

// æ³¨å†Œæ’ä»¶
func init() {
    driverbox.EnablePlugin("myprotocol", &MyProtocol{})
}
```

#### 2. å®ç°å¯¼å‡ºæ’ä»¶

```go
package myexport

import (
    "github.com/ibuilding-x/driver-box/exports/export"
)

type MyExport struct {
    // å¯¼å‡ºå­—æ®µ
}

func (e *MyExport) Init() error {
    // åˆå§‹åŒ–å¯¼å‡º
    return nil
}

func (e *MyExport) Destroy() error {
    // é”€æ¯å¯¼å‡º
    return nil
}

func (e *MyExport) OnData(deviceId string, data interface{}) {
    // å¤„ç†è®¾å¤‡æ•°æ®
}

func (e *MyExport) OnEvent(eventType string, deviceId string, data interface{}) {
    // å¤„ç†è®¾å¤‡äº‹ä»¶
}

// æ³¨å†Œå¯¼å‡º
func init() {
    exports.EnableExport(&MyExport{})
}
```

### ğŸ“š è¯¦ç»†å¼€å‘æ–‡æ¡£

å®Œæ•´çš„äºŒæ¬¡å¼€å‘æ–‡æ¡£è¯·å‚è€ƒï¼š

- **[æ’ä»¶å¼€å‘æŒ‡å—](https://ibuilding-x.github.io/driver-box/plugins/development)** - è¯¦ç»†çš„ Plugin å’Œ Connector æ¥å£å®ç°æŒ‡å—
- **[å¯¼å‡ºå¼€å‘æŒ‡å—](https://ibuilding-x.github.io/driver-box/exports/development)** - æ•°æ®å¯¼å‡ºåŠŸèƒ½å¼€å‘æ•™ç¨‹
- **[Lua è„šæœ¬å¼€å‘](https://ibuilding-x.github.io/driver-box/)** - Lua è„šæœ¬ç¼–ç¨‹å’Œå†…ç½®åº“æ–‡æ¡£

---

## ğŸŒ API æ–‡æ¡£

DriverBox æä¾›äº†ä¸°å¯Œçš„ RESTful APIï¼Œæ¶µç›–è®¾å¤‡ç®¡ç†ã€æ•°æ®æŸ¥è¯¢ã€æ§åˆ¶æ“ä½œç­‰ã€‚

### æ ¸å¿ƒæ¥å£

#### è®¾å¤‡ç®¡ç†
- `GET /api/devices` - è·å–è®¾å¤‡åˆ—è¡¨
- `GET /api/devices/:id` - è·å–è®¾å¤‡è¯¦æƒ…
- `POST /api/devices` - æ·»åŠ è®¾å¤‡
- `PUT /api/devices/:id` - æ›´æ–°è®¾å¤‡é…ç½®
- `DELETE /api/devices/:id` - åˆ é™¤è®¾å¤‡

#### æ•°æ®æ“ä½œ
- `GET /api/devices/:id/points` - è·å–è®¾å¤‡ç‚¹ä½åˆ—è¡¨
- `GET /api/devices/:id/data` - è·å–è®¾å¤‡å®æ—¶æ•°æ®
- `POST /api/devices/:id/read` - è¯»å–æŒ‡å®šç‚¹ä½
- `POST /api/devices/:id/write` - å†™å…¥ç‚¹ä½æ•°æ®

#### è®¾å¤‡æ§åˆ¶
- `POST /api/devices/:id/start` - å¯åŠ¨è®¾å¤‡
- `POST /api/devices/:id/stop` - åœæ­¢è®¾å¤‡
- `POST /api/devices/:id/restart` - é‡å¯è®¾å¤‡

#### é…ç½®ç®¡ç†
- `GET /api/config` - è·å–ç³»ç»Ÿé…ç½®
- `PUT /api/config` - æ›´æ–°ç³»ç»Ÿé…ç½®
- `POST /api/plugins/:name/reload` - é‡è½½æ’ä»¶é…ç½®

> è¯¦ç»† API æ–‡æ¡£è¯·å‚è€ƒï¼š[API å‚è€ƒæ‰‹å†Œ](https://ibuilding-x.github.io/driver-box/api)

### Go SDK

ä¹Ÿå¯ä»¥åœ¨ Go ä»£ç ä¸­ç›´æ¥è°ƒç”¨ DriverBox SDKï¼š

```go
import "github.com/ibuilding-x/driver-box/driverbox"

// è¯»å–ç‚¹ä½
err := driverbox.ReadPoint("device001", "temperature")

// å†™å…¥ç‚¹ä½
data := plugin.PointData{
    PointName: "switch",
    Value:     true,
}
err := driverbox.WritePoint("device001", data)

// æ‰¹é‡è¯»å–
points := []plugin.PointData{
    {PointName: "temperature"},
    {PointName: "humidity"},
}
err := driverbox.ReadPoints("device001", points)

// æ‰¹é‡å†™å…¥
points := []plugin.PointData{
    {PointName: "switch1", Value: true},
    {PointName: "switch2", Value: false},
}
err := driverbox.WritePoints("device001", points)
```

---

## ğŸ¯ åº”ç”¨åœºæ™¯

DriverBox é€‚ç”¨äºå¤šç§ç‰©è”ç½‘åœºæ™¯ï¼š

| åœºæ™¯ | è¯´æ˜ | æ”¯æŒè®¾å¤‡ |
|------|------|---------|
| **æ™ºæ…§æ¥¼å®‡** | HVAC ç³»ç»Ÿã€ç…§æ˜ç³»ç»Ÿã€ç”µæ¢¯ç³»ç»Ÿ | ç©ºè°ƒæœºç»„ã€ç…§æ˜æ§åˆ¶å™¨ã€ç”µè¡¨ã€æ°´è¡¨ |
| **æ™ºæ…§å·¥å‚** | ç”Ÿäº§è®¾å¤‡ç›‘æ§ã€èƒ½è€—ç®¡ç† | PLCã€å˜é¢‘å™¨ã€ä¼ æ„Ÿå™¨ã€æ‰§è¡Œå™¨ |
| **æ™ºèƒ½å®¶å±…** | å®¶ç”¨è®¾å¤‡è”ç½‘ã€åœºæ™¯è”åŠ¨ | æ™ºèƒ½é—¨é”ã€æ™ºèƒ½å®¶ç”µã€ç¯å¢ƒä¼ æ„Ÿå™¨ |
| **æ™ºæ…§é—¨åº—** | è®¾å¤‡ç›‘æ§ã€æ•°æ®åˆ†æ | å†·é“¾è®¾å¤‡ã€POS æœºã€ç›‘æ§æ‘„åƒå¤´ |
| **æ™ºæ…§å›­åŒº** | ç»¼åˆè®¾æ–½ç®¡ç† | èƒ½æºç³»ç»Ÿã€å®‰é˜²ç³»ç»Ÿã€åœè½¦ç³»ç»Ÿ |

### å…¸å‹æ¡ˆä¾‹

- âœ… **å¤šå“ç‰Œ VRF ç©ºè°ƒæ¥å…¥** - æ”¯æŒ å¤§é‡‘ã€æ—¥ç«‹ã€æµ·å°”ã€ç¾çš„ç­‰å“ç‰Œï¼Œç»Ÿä¸€æ•°æ®æ ‡å‡†
- âœ… **èƒ½è€—ç®¡ç†ç³»ç»Ÿ** - æ¥å…¥å„ç±»ç”µè¡¨ã€æ°´è¡¨ã€ç‡ƒæ°”è¡¨ï¼Œå®ç°èƒ½è€—ç›‘æ§å’Œåˆ†æ
- âœ… **æ¥¼å®‡è‡ªæ§ç³»ç»Ÿ** - é›†æˆ BACnetã€Modbus è®¾å¤‡ï¼Œå®ç°ç»Ÿä¸€æ§åˆ¶å’Œç®¡ç†
- âœ… **å·¥ä¸šè®¾å¤‡è”ç½‘** - å°†ä¼ ç»Ÿå·¥ä¸šè®¾å¤‡è¿æ¥åˆ°äº‘å¹³å°ï¼Œå®ç°è¿œç¨‹ç›‘æ§

---

## ğŸ“Š æ€§èƒ½ç‰¹æ€§

- **å¹¶å‘èƒ½åŠ›**ï¼šå•å®ä¾‹æ”¯æŒ 1000+ è®¾å¤‡å¹¶å‘æ¥å…¥
- **å¤„ç†æ€§èƒ½**ï¼šæ¯ç§’å¤„ç† 10000+ æ•°æ®ç‚¹
- **å†…å­˜å ç”¨**ï¼šç©ºé—²çŠ¶æ€ < 50MBï¼Œæ­£å¸¸è¿è¡Œ < 200MB
- **ç¨³å®šæ€§**ï¼š7Ã—24 å°æ—¶ç¨³å®šè¿è¡Œï¼Œè‡ªåŠ¨æ•…éšœæ¢å¤

---

## ğŸ¤ å‚ä¸è´¡çŒ®

æ¬¢è¿å‚ä¸ DriverBox çš„å¼€å‘ï¼Œæ‚¨çš„è´¡çŒ®å°†å¸®åŠ©æ›´å¤šå¼€å‘è€…ï¼

### è´¡çŒ®æµç¨‹

1. **Fork** æœ¬ä»“åº“
2. **åˆ›å»ºç‰¹æ€§åˆ†æ”¯** (`git checkout -b feat/AmazingFeature`)
3. **æäº¤æ›´æ”¹** (`git commit -m 'Add some AmazingFeature'`)
4. **æ¨é€åˆ°åˆ†æ”¯** (`git push origin feat/AmazingFeature`)
5. **æäº¤ Pull Request**

### ä»£ç è§„èŒƒ

- éµå¾ª [Effective Go](https://go.dev/doc/effective_go) ç¼–ç è§„èŒƒ
- æäº¤ä¿¡æ¯éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/)
- æ·»åŠ å¿…è¦çš„å•å…ƒæµ‹è¯•å’Œæ–‡æ¡£æ³¨é‡Š
- ç¡®ä¿é€šè¿‡æ‰€æœ‰æµ‹è¯•æ£€æŸ¥

---

## ğŸ“œ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ **Apache License 2.0** å¼€æºåè®®ï¼Œå…è®¸å•†ä¸šä½¿ç”¨ã€‚

```
Copyright 2024 iBUILDING-X

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```

---

## ğŸ“ åé¦ˆä¸æ”¯æŒ

### è·å–å¸®åŠ©

- ğŸ“š **[å®˜æ–¹æ–‡æ¡£](https://ibuilding-x.github.io/driver-box/)** - å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£å’Œ API å‚è€ƒ
- ğŸ› **[Issue åé¦ˆ](https://github.com/ibuilding-X/driver-box/issues)** - æŠ¥å‘Š Bug æˆ–æäº¤åŠŸèƒ½è¯·æ±‚
- ğŸ’¬ **[è®¨è®ºåŒº](https://github.com/ibuilding-X/driver-box/discussions)** - äº¤æµä½¿ç”¨ç»éªŒå’Œæœ€ä½³å®è·µ
- ğŸ” **[DeepWiki](https://deepwiki.com/ibuilding-X/driver-box)** - AI é©±åŠ¨çš„çŸ¥è¯†åº“é—®ç­”

### è”ç³»æ–¹å¼

å¦‚æœ‰å•†ä¸šåˆä½œéœ€æ±‚æˆ–æŠ€æœ¯æ”¯æŒï¼Œè¯·é€šè¿‡ Issue æˆ– Discussion è”ç³»æˆ‘ä»¬ã€‚

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š

- [EdgeX Foundry](https://www.edgexfoundry.org/) - è¾¹ç¼˜è®¡ç®—æ¡†æ¶çš„å¯å‘
- [Golang](https://golang.org/) - å¼ºå¤§çš„ Go è¯­è¨€ç”Ÿæ€
- [Yuin/gopher-lua](https://github.com/yuin/gopher-lua) - Lua è§£é‡Šå™¨
- æ‰€æœ‰è´¡çŒ®è€…çš„ä»£ç è´¡çŒ®å’Œå»ºè®®

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ï¸ Starï¼**

[â¬† å›åˆ°é¡¶éƒ¨](#driver-box)

</div>
